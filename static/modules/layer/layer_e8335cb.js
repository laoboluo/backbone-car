define("static/modules/layer/layer",function(i,e,t){var a=$(window).height(),n=$(window).width(),l=Backbone.View.extend({imageId:0,nowidx:1,imageList:[],events:{"tap .layer-container img":"toggleTitle","swipeLeft .layer-container img":"showNextImage","swipeRight .layer-container img":"showPreImage","tap .layer .go-back":"goBack"},tpl:_.template($("#tpl_layer").html()),render:function(i){var e=this.collection.get(i);if(!e)return void(location.href="");this.imageId=e.get("id"),this.imageList.push(this.imageId);var t={url:e.get("url"),title:e.get("title"),style:"line-height: "+a+"px;"},l=this.tpl,s=l(t);this.$el.find(".layer").html(s),this.$el.find(".layer-container img").attr("width",n)},goBack:function(){if(this.imageList.pop(),this.imageList.length){var i=this.imageList[this.imageList.length-1],e=this.collection.get(i);this.updateView(e)}else this.$el.find(".layer").hide()},toggleTitle:function(){this.$el.find(".layer .header").toggleClass("hide")},showNextImage:function(){this.imageId++;var i=this.collection.get(this.imageId);if(i?this.imageList.push(this.imageId):(alert("已经是最后一张了！"),this.imageId--),event.preventDefault(),!this.$el.find(".layer-container ul li img").is("animated")){this.$el.find(".layer-container ul li").eq(this.nowidx).animate({transform:"translateX(-100%)"},500),this.nowidx++,this.nowidx>2&&(this.nowidx=0),this.$el.find(".layer-container ul li img").eq(this.nowidx).attr("src",i.get("url"));var e=i.get("url");console.log(e),this.$el.find(".layer-container ul li ").eq(this.nowidx).css("transform","translateX(100%)").animate({transform:"none"},500),this.$el.find(".layer .header h1").html(i.get("title"))}},showPreImage:function(){this.imageId--;var i=this.collection.get(this.imageId);if(i){if(this.imageList.push(this.imageId),this.$el.find(".layer-container ul li").eq(this.nowidx).animate({transform:"translateX(100%)"},500),this.nowidx++,this.nowidx>2&&(this.nowidx=0),this.$el.find(".layer-container ul li img").is("animated"))return;this.$el.find(".layer-container ul li img").eq(this.nowidx).attr("src",i.get("url"));var e=i.get("url");console.log(e),this.$el.find(".layer-container ul li ").eq(this.nowidx).css("transform","translateX(-100%)").animate({transform:"none"},500),this.$el.find(".layer .header h1").html(i.get("title"))}else alert("已经是第一张了！"),this.imageId++},updateView:function(i){this.$el.find(".layer-container img").attr("src",i.get("url")),this.$el.find(".layer .header h1").html(i.get("title"))}});t.exports=l});